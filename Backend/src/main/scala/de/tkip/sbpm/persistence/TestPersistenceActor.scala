package de.tkip.sbpm.persistence

import akka.actor.Actor
import de.tkip.sbpm.model._

// internal testdata structure 
class InternalProcessRepresentation(val name: String,
                                    val role: List[String],
                                    val user: List[String],
                                    val relation: List[String],
                                    val processInstance: List[String],
                                    val message: List[String],
                                    val groupUser: List[String],
                                    val groupRole: List[String],
                                    val group: List[String],
                                    val startSubject: String,
                                    val graph: String) {}

class TestPersistenceActor extends Actor {

  // TODO um roles user usw erweitern
  val testGraph = new InternalProcessRepresentation(
    "purchase",
    List(),
    List(),
    List(),
    List(),
    List(),
    List(),
    List(),
    List(),
    "Subj1",
    de.tkip.sbpm.rest.test.MyJSONTestGraph.processGraph)

  // collection that keeps the hardcoded test data
  val processes = new scala.collection.mutable.HashMap[Int, InternalProcessRepresentation]

  // add a default process 
  processes += (
    2 -> testGraph,
    1 -> new InternalProcessRepresentation("Travel Request",
      List("Employee", "Manager", "Human Resource", "Finance Resource"),
      List("Admin", "Alice", "Bob", "Eve"),
      List("Relation"),
      List("ProcessInstance"),
      List("Messages"),
      List("0,1,3,0", "0,2,2,0", "0,3,4,0"),
      List("2,2,1", "3,1,1", "4,3,1"),
      List("Employee", "Manager", "Human Resource", "Finance Resource"),
      "[{''ID'':''1'',''name'':''Employee'',''active'':''1''}," +
        "{''ID'':''2'',''name'':''Manager'',''active'':''1''}," +
        "{''ID'':''3'',''name'':''Human Resource'',''active'':''1''}]",
      "0x7b2270726f63657373223a5b7b226964223a22456d706c6f796565222c226e616d65223a224170706c6963616e74" +
        "222c2274797065223a2273696e676c65222c226465616374697661746564223a66616c73652c22696e707574506f6f" +
        "6c223a3130302c2272656c6174656450726f63657373223a6e756c6c2c2272656c617465645375626a656374223a6e" +
        "756c6c2c2265787465726e616c54797065223a2265787465726e616c222c22726f6c65223a22456d706c6f79656522" +
        "2c226e6f646573223a5b7b226964223a226e30222c2274657874223a22507265706172652054726176656c20417070" +
        "6c69636174696f6e222c227374617274223a747275652c22656e64223a66616c73652c2274797065223a2261637469" +
        "6f6e222c226465616374697661746564223a66616c73652c226f7074696f6e73223a7b226d657373616765223a222a" +
        "222c227375626a656374223a222a227d7d2c7b226964223a226e31222c2274657874223a22222c227374617274223a" +
        "66616c73652c22656e64223a66616c73652c2274797065223a2273656e64222c226465616374697661746564223a66" +
        "616c73652c226f7074696f6e73223a7b226d657373616765223a222a222c227375626a656374223a222a227d7d2c7b" +
        "226964223a226e32222c2274657874223a22222c227374617274223a66616c73652c22656e64223a66616c73652c22" +
        "74797065223a2272656365697665222c226465616374697661746564223a66616c73652c226f7074696f6e73223a7b" +
        "226d657373616765223a222a222c227375626a656374223a222a227d7d2c7b226964223a226e33222c227465787422" +
        "3a22456e642070726f63657373222c227374617274223a66616c73652c22656e64223a747275652c2274797065223a" +
        "22656e64222c226465616374697661746564223a66616c73652c226f7074696f6e73223a7b226d657373616765223a" +
        "222a222c227375626a656374223a222a227d7d2c7b226964223a226e37222c2274657874223a224465636964652077" +
        "6865746865722066696c696e6720616761696e222c227374617274223a66616c73652c22656e64223a66616c73652c" +
        "2274797065223a22616374696f6e222c226465616374697661746564223a66616c73652c226f7074696f6e73223a7b" +
        "226d657373616765223a222a222c227375626a656374223a222a227d7d2c7b226964223a226e38222c227465787422" +
        "3a22222c227374617274223a66616c73652c22656e64223a66616c73652c2274797065223a2273656e64222c226465" +
        "616374697661746564223a66616c73652c226f7074696f6e73223a7b226d657373616765223a222a222c227375626a" +
        "656374223a222a227d7d2c7b226964223a226e39222c2274657874223a224d616b652074726176656c222c22737461" +
        "7274223a66616c73652c22656e64223a66616c73652c2274797065223a22616374696f6e222c226465616374697661" +
        "746564223a66616c73652c226f7074696f6e73223a7b226d657373616765223a222a222c227375626a656374223a22" +
        "2a227d7d5d2c226564676573223a5b7b227374617274223a226e30222c22656e64223a226e31222c2274657874223a" +
        "22446f6e65222c2274797065223a2265786974636f6e646974696f6e222c22746172676574223a22222c2264656163" +
        "74697661746564223a66616c73652c226f7074696f6e616c223a66616c73652c227072696f72697479223a312c226d" +
        "616e75616c54696d656f7574223a66616c73657d2c7b227374617274223a226e31222c22656e64223a226e32222c22" +
        "74657874223a226d30222c2274797065223a2265786974636f6e646974696f6e222c22746172676574223a7b226964" +
        "223a224d616e61676572222c226d696e223a2d312c226d6178223a2d312c226372656174654e6577223a66616c7365" +
        "7d2c226465616374697661746564223a66616c73652c226f7074696f6e616c223a66616c73652c227072696f726974" +
        "79223a312c226d616e75616c54696d656f7574223a66616c73657d2c7b227374617274223a226e32222c22656e6422" +
        "3a226e37222c2274657874223a226d31222c2274797065223a2265786974636f6e646974696f6e222c227461726765" +
        "74223a7b226964223a224d616e61676572222c226d696e223a2d312c226d6178223a2d312c226372656174654e6577" +
        "223a66616c73657d2c226465616374697661746564223a66616c73652c226f7074696f6e616c223a66616c73652c22" +
        "7072696f72697479223a312c226d616e75616c54696d656f7574223a66616c73657d2c7b227374617274223a226e37" +
        "222c22656e64223a226e38222c2274657874223a2244656e69616c206163636570746564222c2274797065223a2265" +
        "786974636f6e646974696f6e222c22746172676574223a22222c226465616374697661746564223a66616c73652c22" +
        "6f7074696f6e616c223a66616c73652c227072696f72697479223a312c226d616e75616c54696d656f7574223a6661" +
        "6c73657d2c7b227374617274223a226e38222c22656e64223a226e33222c2274657874223a226d32222c2274797065" +
        "223a2265786974636f6e646974696f6e222c22746172676574223a7b226964223a224d616e61676572222c226d696e" +
        "223a2d312c226d6178223a2d312c226372656174654e6577223a66616c73657d2c226465616374697661746564223a" +
        "66616c73652c226f7074696f6e616c223a66616c73652c227072696f72697479223a312c226d616e75616c54696d65" +
        "6f7574223a66616c73657d2c7b227374617274223a226e37222c22656e64223a226e30222c2274657874223a225265" +
        "646f2054726176656c204170706c69636174696f6e222c2274797065223a2265786974636f6e646974696f6e222c22" +
        "746172676574223a22222c226465616374697661746564223a66616c73652c226f7074696f6e616c223a66616c7365" +
        "2c227072696f72697479223a312c226d616e75616c54696d656f7574223a66616c73657d2c7b227374617274223a22" +
        "6e32222c22656e64223a226e39222c2274657874223a226d33222c2274797065223a2265786974636f6e646974696f" +
        "6e222c22746172676574223a7b226964223a224d616e61676572222c226d696e223a2d312c226d6178223a2d312c22" +
        "6372656174654e6577223a66616c73657d2c226465616374697661746564223a66616c73652c226f7074696f6e616c" +
        "223a66616c73652c227072696f72697479223a312c226d616e75616c54696d656f7574223a66616c73657d2c7b2273" +
        "74617274223a226e39222c22656e64223a226e33222c2274657874223a22222c2274797065223a2265786974636f6e" +
        "646974696f6e222c22746172676574223a22222c226465616374697661746564223a66616c73652c226f7074696f6e" +
        "616c223a66616c73652c227072696f72697479223a312c226d616e75616c54696d656f7574223a66616c73657d5d2c" +
        "226e6f6465436f756e746572223a31307d2c7b226964223a224d616e61676572222c226e616d65223a225375706572" +
        "7669736f72222c2274797065223a2273696e676c65222c226465616374697661746564223a66616c73652c22696e70" +
        "7574506f6f6c223a3130302c2272656c6174656450726f63657373223a6e756c6c2c2272656c617465645375626a65" +
        "6374223a6e756c6c2c2265787465726e616c54797065223a2265787465726e616c222c22726f6c65223a224d616e61" +
        "676572222c226e6f646573223a5b7b226964223a226e30222c2274657874223a22222c227374617274223a74727565" +
        "2c22656e64223a66616c73652c2274797065223a2272656365697665222c226465616374697661746564223a66616c" +
        "73652c226f7074696f6e73223a7b226d657373616765223a222a222c227375626a656374223a222a227d7d2c7b2269" +
        "64223a226e31222c2274657874223a22222c227374617274223a66616c73652c22656e64223a66616c73652c227479" +
        "7065223a2273656e64222c226465616374697661746564223a66616c73652c226f7074696f6e73223a7b226d657373" +
        "616765223a222a222c227375626a656374223a222a227d7d2c7b226964223a226e3132222c2274657874223a22222c" +
        "227374617274223a66616c73652c22656e64223a66616c73652c2274797065223a2273656e64222c22646561637469" +
        "7661746564223a66616c73652c226f7074696f6e73223a7b226d657373616765223a222a222c227375626a65637422" +
        "3a222a227d7d2c7b226964223a226e3133222c2274657874223a22456e642050726f63657373222c22737461727422" +
        "3a66616c73652c22656e64223a747275652c2274797065223a22656e64222c226465616374697661746564223a6661" +
        "6c73652c226f7074696f6e73223a7b226d657373616765223a222a222c227375626a656374223a222a227d7d2c7b22" +
        "6964223a226e3134222c2274657874223a22222c227374617274223a66616c73652c22656e64223a66616c73652c22" +
        "74797065223a2272656365697665222c226465616374697661746564223a66616c73652c226f7074696f6e73223a7b" +
        "226d657373616765223a222a222c227375626a656374223a222a227d7d2c7b226964223a226e3135222c2274657874" +
        "223a22436865636b2054726176656c204170706c69636174696f6e222c227374617274223a66616c73652c22656e64" +
        "223a66616c73652c2274797065223a22616374696f6e222c226465616374697661746564223a66616c73652c226f70" +
        "74696f6e73223a7b226d657373616765223a222a222c227375626a656374223a222a227d7d2c7b226964223a226e31" +
        "36222c2274657874223a22222c227374617274223a66616c73652c22656e64223a66616c73652c2274797065223a22" +
        "73656e64222c226465616374697661746564223a66616c73652c226f7074696f6e73223a7b226d657373616765223a" +
        "222a222c227375626a656374223a222a227d7d5d2c226564676573223a5b7b227374617274223a226e31222c22656e" +
        "64223a226e3132222c2274657874223a226d33222c2274797065223a2265786974636f6e646974696f6e222c227461" +
        "72676574223a7b226964223a22456d706c6f796565222c226d696e223a2d312c226d6178223a2d312c226372656174" +
        "654e6577223a66616c73657d2c226465616374697661746564223a66616c73652c226f7074696f6e616c223a66616c" +
        "73652c227072696f72697479223a312c226d616e75616c54696d656f7574223a66616c73657d2c7b22737461727422" +
        "3a226e3132222c22656e64223a226e3133222c2274657874223a226d34222c2274797065223a2265786974636f6e64" +
        "6974696f6e222c22746172676574223a7b226964223a2248756d616e205265736f75726365222c226d696e223a2d31" +
        "2c226d6178223a2d312c226372656174654e6577223a66616c73657d2c226465616374697661746564223a66616c73" +
        "652c226f7074696f6e616c223a66616c73652c227072696f72697479223a312c226d616e75616c54696d656f757422" +
        "3a66616c73657d2c7b227374617274223a226e3134222c22656e64223a226e3133222c2274657874223a226d32222c" +
        "2274797065223a2265786974636f6e646974696f6e222c22746172676574223a7b226964223a22456d706c6f796565" +
        "222c226d696e223a2d312c226d6178223a2d312c226372656174654e6577223a66616c73657d2c2264656163746976" +
        "61746564223a66616c73652c226f7074696f6e616c223a66616c73652c227072696f72697479223a312c226d616e75" +
        "616c54696d656f7574223a66616c73657d2c7b227374617274223a226e30222c22656e64223a226e3135222c227465" +
        "7874223a226d30222c2274797065223a2265786974636f6e646974696f6e222c22746172676574223a7b226964223a" +
        "22456d706c6f796565222c226d696e223a2d312c226d6178223a2d312c226372656174654e6577223a66616c73657d" +
        "2c226465616374697661746564223a66616c73652c226f7074696f6e616c223a66616c73652c227072696f72697479" +
        "223a312c226d616e75616c54696d656f7574223a66616c73657d2c7b227374617274223a226e3135222c22656e6422" +
        "3a226e31222c2274657874223a224772616e74205065726d697373696f6e222c2274797065223a2265786974636f6e" +
        "646974696f6e222c22746172676574223a22222c226465616374697661746564223a66616c73652c226f7074696f6e" +
        "616c223a66616c73652c227072696f72697479223a312c226d616e75616c54696d656f7574223a66616c73657d2c7b" +
        "227374617274223a226e3134222c22656e64223a226e3135222c2274657874223a226d30222c2274797065223a2265" +
        "786974636f6e646974696f6e222c22746172676574223a7b226964223a22456d706c6f796565222c226d696e223a2d" +
        "312c226d6178223a2d312c226372656174654e6577223a66616c73657d2c226465616374697661746564223a66616c" +
        "73652c226f7074696f6e616c223a66616c73652c227072696f72697479223a312c226d616e75616c54696d656f7574" +
        "223a66616c73657d2c7b227374617274223a226e3135222c22656e64223a226e3136222c2274657874223a2244656e" +
        "79205065726d697373696f6e222c2274797065223a2265786974636f6e646974696f6e222c22746172676574223a22" +
        "222c226465616374697661746564223a66616c73652c226f7074696f6e616c223a66616c73652c227072696f726974" +
        "79223a312c226d616e75616c54696d656f7574223a66616c73657d2c7b227374617274223a226e3136222c22656e64" +
        "223a226e3134222c2274657874223a226d31222c2274797065223a2265786974636f6e646974696f6e222c22746172" +
        "676574223a7b226964223a22456d706c6f796565222c226d696e223a2d312c226d6178223a2d312c22637265617465" +
        "4e6577223a66616c73657d2c226465616374697661746564223a66616c73652c226f7074696f6e616c223a66616c73" +
        "652c227072696f72697479223a312c226d616e75616c54696d656f7574223a66616c73657d5d2c226e6f6465436f75" +
        "6e746572223a31377d2c7b226964223a2248756d616e205265736f75726365222c226e616d65223a2241646d696e69" +
        "7374726174696f6e222c2274797065223a2273696e676c65222c226465616374697661746564223a66616c73652c22" +
        "696e707574506f6f6c223a3130302c2272656c6174656450726f63657373223a6e756c6c2c2272656c617465645375" +
        "626a656374223a6e756c6c2c2265787465726e616c54797065223a2265787465726e616c222c22726f6c65223a2248" +
        "756d616e205265736f75726365222c226e6f646573223a5b7b226964223a226e30222c2274657874223a22222c2273" +
        "74617274223a747275652c22656e64223a66616c73652c2274797065223a2272656365697665222c22646561637469" +
        "7661746564223a66616c73652c226f7074696f6e73223a7b226d657373616765223a222a222c227375626a65637422" +
        "3a222a227d7d2c7b226964223a226e31222c2274657874223a2248616e646c652054726176656c204170706c696361" +
        "74696f6e222c227374617274223a66616c73652c22656e64223a66616c73652c2274797065223a22616374696f6e22" +
        "2c226465616374697661746564223a66616c73652c226f7074696f6e73223a7b226d657373616765223a222a222c22" +
        "7375626a656374223a222a227d7d2c7b226964223a226e32222c2274657874223a22456e642070726f63657373222c" +
        "227374617274223a66616c73652c22656e64223a747275652c2274797065223a22656e64222c226465616374697661" +
        "746564223a66616c73652c226f7074696f6e73223a7b226d657373616765223a222a222c227375626a656374223a22" +
        "2a227d7d5d2c226564676573223a5b7b227374617274223a226e30222c22656e64223a226e31222c2274657874223a" +
        "226d34222c2274797065223a2265786974636f6e646974696f6e222c22746172676574223a7b226964223a224d616e" +
        "61676572222c226d696e223a2d312c226d6178223a2d312c226372656174654e6577223a66616c73657d2c22646561" +
        "6374697661746564223a66616c73652c226f7074696f6e616c223a66616c73652c227072696f72697479223a312c22" +
        "6d616e75616c54696d656f7574223a66616c73657d2c7b227374617274223a226e31222c22656e64223a226e32222c" +
        "2274657874223a2254726176656c204170706c69636174696f6e2066696c6564222c2274797065223a226578697463" +
        "6f6e646974696f6e222c22746172676574223a22222c226465616374697661746564223a66616c73652c226f707469" +
        "6f6e616c223a66616c73652c227072696f72697479223a312c226d616e75616c54696d656f7574223a66616c73657d" +
        "5d2c226e6f6465436f756e746572223a337d5d2c226d65737361676573223a7b226d30223a2254726176656c204170" +
        "706c69636174696f6e222c226d31223a225065726d697373696f6e2064656e696564222c226d32223a224e6f206675" +
        "72746865723c6272202f3e54726176656c204170706c69636174696f6e222c226d33223a225065726d697373696f6e" +
        "206772616e746564222c226d34223a22417070726f7665643c6272202f3e54726176656c204170706c69636174696f" +
        "6e227d2c226d657373616765436f756e746572223a352c226e6f6465436f756e746572223a332c22726573706f6e73" +
        "6962696c6974696573223a5b5d2c22726f7574696e6773223a5b5d7d"))

  // send hardcoded test data to sender, 
  // currently there is just one process with ID: 1
  def receive = {

    case GetRole(_) => sender ! processes.get(1).get.role

    case GetUser => sender ! processes.get(1).get.user

    case GetRelation() => sender ! processes.get(1).get.relation

    case GetProcess(_, _) => sender !
      Some(Process(Some(1), "DataBaseProcess", 2, true, "[{'ID':'1','name':'Subj1','active':'1'}]"))

    case GetProcessInstance(_) => sender ! processes.get(1).get.name

    case GetMessage(_) => sender ! processes.get(1).get.message

    case GetGroupUser => sender ! processes.get(1).get.groupUser

    case GetGroupRole => sender ! processes.get(1).get.groupRole

    case GetGroup(_) => sender ! processes.get(1).get.group

    case GetGraph(_) => sender !
      Some(Graph(Some(2), processes.get(2).get.graph, null, 1))

    case save: SaveProcessInstance => {
      println("TestPersistenceActor - ProcessInstance saved: " + save)
      sender ! Some(2)
    }

    case s => println("TestPersistenceActor - This feature is not yet implemented: " + s)
  }

}
