<div>
<div class="inner">

	<div id="contentHead" class="clearfix">
		<h3 id="processName" style="color:#525252" >
			Currently available Processes
		</h3>
	</div>
	<!-- End header -->
	<div id="filter">
		<select class="sel" data-placeholder="Select Process" data-bind="options: availableProcesses, optionsText: 'name', optionsValue: 'id'"></select>
		<label for="from">From:</label>
		<span class="clearable">
			<input class="data_field" type="text" id="from" name="from" data-bind="value: selectedStart" /><span class="icon_clear">x</span>
		</span>
		<label for="to">To:</label>
		<span class="clearable">
			<input class="data_field" id="to" name="to" type="text" data-bind="value: selectedEnd" /><span class="icon_clear">x</span>
		</span>
	</div>
	<hr>
	<div id="clickablelist">
		<table class="table table-hover table-middle result processlist">
			<thead>
				<tr class="processhead">
					<th class="col1"></th>
					<th class="col2">Name </th>
					<th class="col3"> Actions </th>
				</tr>
			</thead>
			<tbody data-bind='foreach: Process.all()'>
				<tr data-bind="click:  function() { if($data.hasInstances&&$data.startAble()) $('#'+id()).toggle(); $('#icon-triangle-s'+id()).toggle(); $('#icon-triangle-n'+id()).toggle(); }, style: { cursor: $data.hasInstances()&&$data.startAble() ? 'pointer' : '' }, attr: { class: !$data.hasInstances()||!$data.startAble() ? 'processitem noinstances' : 'processitem' }  ">
					<td class="col1">
						<!-- ko if: $data.hasInstances()&&$data.startAble() -->
						<span data-bind="attr: {id: 'icon-triangle-s'+id()}" class="glyphicon glyphicon-chevron-down"></span>
						<span data-bind="attr: {id: 'icon-triangle-n'+id()}" class="glyphicon glyphicon-chevron-up" style="display: none;"></span>
						<!-- /ko -->
					</td>
					<td class="col2">
						<a href="#" data-bind="click:  function() { window.location.href=url();  }, text: menuName()"></a> (<span data-bind="text: instanceCount"></span>)
					</td>
					<td class="col3">
						<div class="btn-group">
							<a class="btn btn-primary" href="#" data-bind="click: $parent.showProcessNameModal, css: { disabled: !$data.startAble() }"><i class="glyphicon glyphicon-new-window"></i> new Instance</a>
						</div>
						<div class="btn-group">
							<a class="btn btn-info" data-bind="click:  function() { window.location.href=url();  }"><i class="glyphicon glyphicon-pencil"></i> Edit</a>
						</div>
						<div class="btn-group">
							<button class="btn btn-danger" data-bind="click: $parent.remove"><i class="glyphicon glyphicon-remove-circle"></i> Delete</button>
						</div>
					</td>
				</tr>
				<!-- ko if: $data.hasInstances -->
				<tr style="display: none;" data-bind="attr: {id: id()}" class="instances">
					<td colspan="4" class="item_info">
						<!-- ko foreach: $data.processInstances -->
						<table class="table" style="border:0;" >
							<tr>
								<td class="col1">
									<!-- ko if: executable() -->
							<img src="images/icons/circle-green-24-ns.png" title="Action required"/>
							<!-- /ko -->

							<!-- ko if: (!executable() && hasActions()) -->
							<img src="images/icons/circle-yellow-24-ns.png" title="Waiting for other user"/>
							<!-- /ko -->

							<!-- ko if: !executable() && !hasActions() -->
							<img src="images/icons/circle-red-24-ns.png" title="completed"/>
							<!-- /ko -->

								</td>
								<td class="col2">
									<strong>Name: </strong><a href="#" data-bind="attr: { href: url() }"><span data-bind="text: name"></span></a><br />
									<strong>Start: </strong> <span data-bind="text: moment(startedAt().date).format('LL')"></span>
								</td>
								<td class="col3">
									<strong>Owner: </strong><span data-bind="text: ownerUser().name()"></a><br />
								</td>
								<td class="col4">
									<a href="" class="btn btn-danger btn-sm" data-bind="click: $parents[1].removeInstance"><i class="glyphicon glyphicon-remove-circle"></i> Delete</a>
								</td>
							</tr>
						</table>

						<!-- /ko -->
					</td>
				</tr>
				<!-- /ko -->
			</tbody>
		</table>

		<div class="form-actions">
			<a class="btn btn-success" href="#/processes/new" style="line-height: 20px;">
				<i class="glyphicon glyphicon-plus"></i>
				Create New Process
			</a>
		</div>
	</div>

</div>
<div id="processNameModal" class="modal fade in" tabindex="-1">
	<div class="modal-dialog">
		<div class="modal-content">
			<form data-bind="submit: newInstance">
				<div class="modal-header">
					<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
					<h3>Process Name</h3>
				</div>
				<div class="modal-body">
					<input type="hidden" name="processId" value="" />
					<input name="instancename" class="form-control" type="text" />
				</div>
				<footer class="modal-footer">
					<input type="submit" class="btn btn-primary" value="Start" />
				</footer>
			</form>
		</div>
	</div>
</div>
